import{r as W,a as D}from"./react-3a085173.js";function at(){return at=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(n[r]=a[r])}return n},at.apply(this,arguments)}var b=function(o,a){return o.querySelector(a)},Pt=function(o,a){return o.querySelectorAll(a)},Xt=function(o){o===void 0&&(o={});var a={};return Object.keys(o).forEach(function(r){typeof o[r]<"u"&&(a[r]=o[r])}),a},Yt={alwaysActive:!1,activeOffset:50,shadowOffset:50,shadowScale:1,duration:300,rotate:!0,rotateTouch:!0,rotateXMax:15,rotateYMax:15,rotateXInvert:!1,rotateYInvert:!1,stretchX:0,stretchY:0,stretchZ:0,commonOrigin:!0,shadow:!0,highlight:!0};function Rt(n){n===void 0&&(n={});var o=n,a=o.el,r=o.eventsEl,X=n,Y=X.isComponent,I,d={__atropos__:!0,params:at({},Yt,{onEnter:null,onLeave:null,onRotate:null},Xt(n||{})),destroyed:!1,isActive:!1},e=d.params,M,E,S,R,$,h,c,C,v,Z,p=[],B,G=function s(){B=requestAnimationFrame(function(){p.forEach(function(t){if(typeof t=="function")t();else{var i=t.element,u=t.prop,f=t.value;i.style[u]=f}}),p.splice(0,p.length),s()})};G();var w=function(t,i){p.push({element:t,prop:"transitionDuration",value:i})},x=function(t,i){p.push({element:t,prop:"transitionTimingFunction",value:i})},O=function(t,i){p.push({element:t,prop:"transform",value:i})},N=function(t,i){p.push({element:t,prop:"opacity",value:i})},J=function(t,i){p.push({element:t,prop:"transformOrigin",value:i})},L=function(t,i,u,f){return t.addEventListener(i,u,f)},T=function(t,i,u,f){return t.removeEventListener(i,u,f)},ft=function(){var t;h=b(a,".atropos-shadow"),h||(h=document.createElement("span"),h.classList.add("atropos-shadow"),t=!0),O(h,"translate3d(0,0,-"+e.shadowOffset+"px) scale("+e.shadowScale+")"),t&&M.appendChild(h)},lt=function(){var t;c=b(a,".atropos-highlight"),c||(c=document.createElement("span"),c.classList.add("atropos-highlight"),t=!0),O(c,"translate3d(0,0,0)"),t&&S.appendChild(c)},V=function(t){var i=t.rotateXPercentage,u=i===void 0?0:i,f=t.rotateYPercentage,l=f===void 0?0:f,m=t.duration,A=t.opacityOnly,j=t.easeOut,F=function(y){if(y.dataset.atroposOpacity&&typeof y.dataset.atroposOpacity=="string")return y.dataset.atroposOpacity.split(";").map(function(P){return parseFloat(P)})};Pt(I,"[data-atropos-offset], [data-atropos-opacity]").forEach(function(g){w(g,m),x(g,j?"ease-out":"");var y=F(g);if(u===0&&l===0)A||O(g,"translate3d(0, 0, 0)"),y&&N(g,y[0]);else{var P=parseFloat(g.dataset.atroposOffset)/100;if(!Number.isNaN(P)&&!A&&O(g,"translate3d("+-l*-P+"%, "+u*-P+"%, 0)"),y){var Q=y[0],tt=y[1],et=Math.max(Math.abs(u),Math.abs(l));N(g,Q+(tt-Q)*et/100)}}})},k=function(t,i){var u=a!==r;if(R||(R=a.getBoundingClientRect()),u&&!$&&($=r.getBoundingClientRect()),typeof t>"u"&&typeof i>"u"){var f=u?$:R;t=f.left+f.width/2,i=f.top+f.height/2}var l=0,m=0,A=R,j=A.top,F=A.left,g=A.width,y=A.height,P;if(u){var U=$,st=U.top,ut=U.left,mt=U.width,gt=U.height,yt=F-ut,Ot=j-st,Mt=g/2+yt,wt=y/2+Ot,xt=t-ut,Ct=i-st;m=e.rotateYMax*(xt-Mt)/(mt-g/2)*-1,l=e.rotateXMax*(Ct-wt)/(gt-y/2),P=t-F+"px "+(i-j)+"px"}else{var Q=g/2,tt=y/2,et=t-F,ht=i-j;m=e.rotateYMax*(et-Q)/(g/2)*-1,l=e.rotateXMax*(ht-tt)/(y/2)}l=Math.min(Math.max(-l,-e.rotateXMax),e.rotateXMax),e.rotateXInvert&&(l=-l),m=Math.min(Math.max(-m,-e.rotateYMax),e.rotateYMax),e.rotateYInvert&&(m=-m);var K=l/e.rotateXMax*100,q=m/e.rotateYMax*100,Et=(u?q/100*e.stretchX:0)*(e.rotateYInvert?-1:1),$t=(u?K/100*e.stretchY:0)*(e.rotateXInvert?-1:1),Nt=u?Math.max(Math.abs(K),Math.abs(q))/100*e.stretchZ:0;O(M,"translate3d("+Et+"%, "+-$t+"%, "+-Nt+"px) rotateX("+l+"deg) rotateY("+m+"deg)"),P&&e.commonOrigin&&J(M,P),c&&(w(c,e.duration+"ms"),x(c,"ease-out"),O(c,"translate3d("+-q*.25+"%, "+K*.25+"%, 0)"),N(c,Math.max(Math.abs(K),Math.abs(q))/100)),V({rotateXPercentage:K,rotateYPercentage:q,duration:e.duration+"ms",easeOut:!0}),typeof e.onRotate=="function"&&e.onRotate(l,m)},rt=function(){p.push(function(){return a.classList.add("atropos-active")}),w(M,e.duration+"ms"),x(M,"ease-out"),O(E,"translate3d(0,0, "+e.activeOffset+"px)"),w(E,e.duration+"ms"),x(E,"ease-out"),h&&(w(h,e.duration+"ms"),x(h,"ease-out")),d.isActive=!0},H=function(t){if(C=void 0,!(t.type==="pointerdown"&&t.pointerType==="mouse")&&!(t.type==="pointerenter"&&t.pointerType!=="mouse")){if(t.type==="pointerdown"&&t.preventDefault(),v=t.clientX,Z=t.clientY,e.alwaysActive){R=void 0,$=void 0;return}rt(),typeof e.onEnter=="function"&&e.onEnter()}},nt=function(t){C===!1&&t.cancelable&&t.preventDefault()},ot=function(t){if(!(!e.rotate||!d.isActive)){if(t.pointerType!=="mouse"){if(!e.rotateTouch)return;t.preventDefault()}var i=t.clientX,u=t.clientY,f=i-v,l=u-Z;if(typeof e.rotateTouch=="string"&&(f!==0||l!==0)&&typeof C>"u"){if(f*f+l*l>=25){var m=Math.atan2(Math.abs(l),Math.abs(f))*180/Math.PI;C=e.rotateTouch==="scroll-y"?m>45:90-m>45}C===!1&&(a.classList.add("atropos-rotate-touch"),t.cancelable&&t.preventDefault())}t.pointerType!=="mouse"&&C||k(i,u)}},_=function(t){if(R=void 0,$=void 0,!!d.isActive&&!(t&&t.type==="pointerup"&&t.pointerType==="mouse")&&!(t&&t.type==="pointerleave"&&t.pointerType!=="mouse")){if(typeof e.rotateTouch=="string"&&C&&a.classList.remove("atropos-rotate-touch"),e.alwaysActive){k(),typeof e.onRotate=="function"&&e.onRotate(0,0),typeof e.onLeave=="function"&&e.onLeave();return}p.push(function(){return a.classList.remove("atropos-active")}),w(E,e.duration+"ms"),x(E,""),O(E,"translate3d(0,0, 0px)"),h&&(w(h,e.duration+"ms"),x(h,"")),c&&(w(c,e.duration+"ms"),x(c,""),O(c,"translate3d(0, 0, 0)"),N(c,0)),w(M,e.duration+"ms"),x(M,""),O(M,"translate3d(0,0,0) rotateX(0deg) rotateY(0deg)"),V({duration:e.duration+"ms"}),d.isActive=!1,typeof e.onRotate=="function"&&e.onRotate(0,0),typeof e.onLeave=="function"&&e.onLeave()}},it=function(t){var i=t.target;!r.contains(i)&&i!==r&&d.isActive&&_()},vt=function(){typeof a=="string"&&(a=b(document,a)),a&&(a.__atropos__||(typeof r<"u"?typeof r=="string"&&(r=b(document,r)):r=a,I=Y?a.parentNode.host:a,Object.assign(d,{el:a}),M=b(a,".atropos-rotate"),E=b(a,".atropos-scale"),S=b(a,".atropos-inner"),a.__atropos__=d))},pt=function(){vt(),!(!a||!r)&&(e.shadow&&ft(),e.highlight&&lt(),e.rotateTouch&&(typeof e.rotateTouch=="string"?a.classList.add("atropos-rotate-touch-"+e.rotateTouch):a.classList.add("atropos-rotate-touch")),b(I,"[data-atropos-opacity]")&&V({opacityOnly:!0}),L(document,"click",it),L(r,"pointerdown",H),L(r,"pointerenter",H),L(r,"pointermove",ot),L(r,"touchmove",nt),L(r,"pointerleave",_),L(r,"pointerup",_),L(r,"lostpointercapture",_),e.alwaysActive&&(rt(),k()))},dt=function(){d.destroyed=!0,cancelAnimationFrame(B),T(document,"click",it),T(r,"pointerdown",H),T(r,"pointerenter",H),T(r,"pointermove",ot),T(r,"touchmove",nt),T(r,"pointerleave",_),T(r,"pointerup",_),T(r,"lostpointercapture",_),delete a.__atropos__};return d.destroy=dt,pt(),d}var Lt=["component","children","rootChildren","scaleChildren","rotateChildren","className","scaleClassName","rotateClassName","innerClassName"];function z(){return z=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(n[r]=a[r])}return n},z.apply(this,arguments)}function Tt(n,o){if(n==null)return{};var a={},r=Object.keys(n),X,Y;for(Y=0;Y<r.length;Y++)X=r[Y],!(o.indexOf(X)>=0)&&(a[X]=n[X]);return a}var ct=["eventsEl","alwaysActive","activeOffset","shadowOffset","shadowScale","duration","rotate","rotateTouch","rotateXMax","rotateYMax","rotateXInvert","rotateYInvert","stretchX","stretchY","stretchZ","commonOrigin","shadow","highlight","onEnter","onLeave","onRotate"],bt=function(o){var a={};return Object.keys(o).forEach(function(r){ct.includes(r)||(a[r]=o[r])}),a},_t=function(o){var a={};return Object.keys(o).forEach(function(r){ct.includes(r)&&(a[r]=o[r])}),a};function Dt(n){var o=n.component,a=o===void 0?"div":o,r=n.children,X=n.rootChildren,Y=n.scaleChildren,I=n.rotateChildren,d=n.className,e=d===void 0?"":d,M=n.scaleClassName,E=M===void 0?"":M,S=n.rotateClassName,R=S===void 0?"":S,$=n.innerClassName,h=$===void 0?"":$,c=Tt(n,Lt),C=W.useRef(null),v=W.useRef(null),Z=a,p=function(){for(var x=arguments.length,O=new Array(x),N=0;N<x;N++)O[N]=arguments[N];return O.filter(function(J){return!!J}).join(" ")},B=function(){v.current=Rt(z({el:C.current},_t(n)))},G=function(){v.current&&(v.current.destroy(),v.current=null)};return W.useEffect(function(){return C.current&&B(),function(){G()}},[]),W.useEffect(function(){return v.current&&(v.current.params.onEnter=n.onEnter,v.current.params.onLeave=n.onLeave,v.current.params.onRotate=n.onRotate),function(){v.current&&(v.current.params.onEnter=null,v.current.params.onLeave=null,v.current.params.onRotate=null)}}),D.createElement(Z,z({className:p("atropos",e)},bt(c),{ref:C}),D.createElement("span",{className:p("atropos-scale",E)},D.createElement("span",{className:p("atropos-rotate",R)},D.createElement("span",{className:p("atropos-inner",h)},r,(n.highlight||typeof n.highlight>"u")&&D.createElement("span",{className:"atropos-highlight"})),I,(n.shadow||typeof n.shadow>"u")&&D.createElement("span",{className:"atropos-shadow"})),Y),X)}export{Dt as A};
